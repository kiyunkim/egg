<style>
  .hidden {
    visibility: hidden;
  }
</style>

<p class="egg">eggs: <span id="egg-count"></span></p>
<button id="egg-btn">get egg</button> <button id="egg-sell" disabled>sell dozen eggs</button>
<p class="money hidden">money: $<span id="money-count"></span></p>
<p class="chicken hidden">chickens: <span id="chicken-count"></span></p>

<script>
  var egg = {
    name: 'egg',
    count: 0,
    html: {
      container: '.egg',
      counter: '#egg-count',
      buyButton: '#egg-btn',
      sellButton: '#egg-sell',
    },
    unlock: [
      {
        atCount: 2,
        name: 'money'
      },
    ],
    sell: {
      money: 0.5, // per one egg
    }
  };
  var money = {
    name: 'money',
    count: 0,
    html: {
      container: '.money',
      counter: '#money-count'
    },
    unlock: [
      {
        name: 'money',
        atCount: 10
      }
    ]
  };
  var chicken = {
    name: 'chicken',
    count: 0,
    html: {
      container: '.chicken'
    },
    buy: {
      type: money.name,
      amount: 20
    },
    produce: {
      type: egg.name,
      amount: 0.5
    },
  };

  var className = {
    hidden: 'hidden'
  }

  // loadSave();
  
  function updateCount(thing) {
    if (!document.querySelector(thing.html.container).classList.contains(className.hidden)) {
      if (thing.name === 'money') {
        document.querySelector(thing.html.counter).innerHTML = thing.count.toFixed(2);
      } else {
        document.querySelector(thing.html.counter).innerHTML = thing.count;
      }
    }
  }

  // set count
  // TODO: make this a loop
  updateCount(egg);
  updateCount(money);
  updateCount(chicken);

  
  // clicker
  function addClickCount(thing) {
    document.querySelector(thing.html.buyButton).addEventListener('click', function() {
      thing.count++;
      updateCount(thing);

      // this should be moved and made less manual
      unlock(egg, money);
      enableButton(egg, 12, egg.html.sellButton);
    });
  }
  addClickCount(egg); // should not be manual

  function checkIfArray(thing) {
    if (Array.isArray(thing)) {
      return true;
    } else {
      return false
    }
  }
  // unhide
  function unhide(hiddenThing){
    document.querySelector(hiddenThing.html.container).classList.remove(className.hidden);
    updateCount(hiddenThing);
  }
  // unlock
  function unlock(unlockingThing, lockedThing) {
    // make sure locked thing is already hidden
    if (document.querySelector(lockedThing.html.container).classList.contains(className.hidden)) {
      // is the locked thing in an array?
      if (checkIfArray(unlockingThing.unlock)) {
        // if yes, loop through array
        for (i = 0; i < unlockingThing.unlock.length; i++) {
          // check name and cost
          if ((lockedThing.name === unlockingThing.unlock[i].name) && (unlockingThing.count >= unlockingThing.unlock[i].atCount)) {
            unhide(lockedThing);
          }
        }
      } else {
        // no it's an object, not array
        if ((lockedThing.name === unlockingThing.unlock.name) && (unlockingThing.count >= unlockingThing.unlock[i].atCount)) {
          unhide(lockedThing);
        }
      }
    }
  }

  // enable buttons
  function enableButton(thing, amount, button) {
    if (thing.count >= amount) {
      document.querySelector(button).disabled = false;
    }
  }

  function sellThing(thing) {
    document.querySelector(thing.html.sellButton).addEventListener('click', function() {

        // ((thing.sell.money * thing.count) + money.count) = money.count;
        updateCount(money);
        console.log('Test!')

    });
  }

  sellThing(egg);

  
</script>